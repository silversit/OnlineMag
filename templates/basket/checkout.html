{% extends 'base.html' %}
{% block content %}
<div class="container text-white mt-5">
    <h2>Checkout Successful</h2>
    <p>Thank you for your order!</p>

    {% if order %}
    <h4 class="mt-4">Order Summary</h4>
    <ul class="list-group mb-4">
        {% for item in order.orderitem_set.all %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
            {{ item.product.name }} (x{{ item.quantity }})
            <span>{{ item.product.price|floatformat:2 }} USD</span>
        </li>
        {% endfor %}
    </ul>

    <ul class="list-group mb-4">
        {% with subtotal=order.orderitem_set.all|map:'total_price'|sum %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
            Subtotal:
            <span>{{ subtotal|floatformat:2 }} USD</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
            Transport Fee:
            <span>{{ order.transport_fee|default:0|floatformat:2 }} USD</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center fw-bold">
            Total Paid:
            <span>{{ subtotal|add:order.transport_fee|floatformat:2 }} USD</span>
        </li>
        {% endwith %}
    </ul>
    {% endif %}

    <a href="{% url 'product-list' %}" class="btn btn-primary">Continue Shopping</a>
</div>
{% endblock %}
